# Box Verification

## Model

The model definition is in the file `modules.py` and the model can be
constructed by calling the function `get_model()`. You are free to experiment
with smaller or larger networks.

The models saved in the `models/` folder were pretrained on MNIST
and were generated by calling the following scripts (adapted from the previous exercise):
```commandline
python train.py --save_model
python train.py --save_model --defense PGD
python train.py --save_model --defense TRADES
```

## Verification

Your task is to complete the definition of the `AbstractBox` class in the file `verify.py`.
The high-level certification logic for a single sample is defined in the function
`certify_sample(...)`. It returns `True` if we can prove the property for the sample
with absolute certainty (so that we are sound). Otherwise, it must return `False`. 

* The method `construct_initial_box` implicitly defines the precondition: it constructs
the initial abstract element (shape) before it is propagated through the neural network.
* The method `check_postcondition` checks if the postcondition
(and hence the desired property) holds.
* Each of the `propagate_` methods defines an abstract transformer for the box domain
for each of the corresponding modules/layers.

To run the certification on each of the pretrained models, you can execute:
```commandline
python verify.py --model_path "models/net_10_none.pt"
python verify.py --model_path "models/net_10_PGD.pt"
python verify.py --model_path "models/net_10_TRADES.pt"
```

By default, the samples are certified one by one and the default
certification epsilon is 0.025. You are free to explore if the certification
can be done in batches and what the results look like for smaller or larger epsilons.
